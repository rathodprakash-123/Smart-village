<%- include('partials/header') %>

<!-- Admin-only: Post Announcement -->
<% if (session.role === 'admin') { %>
  <div class="skills-section">
<section>
  <h2>Post Announcement</h2>
  <form action="/announcement" method="POST">
    <input name="title" placeholder="Enter title" required />
    <textarea name="content" placeholder="Enter content" required></textarea>
    <button>Announce</button>
  </form>
</section>

<!-- Admin-only: Add Blog -->
<section>
  <h2>Add Blog</h2>
  <form action="/vlog" method="POST" enctype="multipart/form-data">
    <input name="head" placeholder="Heading" required />
    <input type="file" name="image" accept="image/*" required />
    <textarea name="context" placeholder="Description" required></textarea>
    <button>Add Blog</button>
  </form>
</section>
  </div>
<% } %> 

<% if(complaints.length !=0) { %>
  <div class="skills-section">
<section>
  <h2>Complaints</h2>
  <% complaints.forEach(c => { %>
  <div class="skills-section">
    <p style="font-size: x-large"><b><%= c.name %></b></p>
    <p><%= c.address %></p>
    <p><%= c.description %></p>
    <p><%= c.date.toDateString() %></p>
    <form action="/complaint/<%= c._id %>?_method=DELETE" method="post">
      <button style="width: 100px; height: 45px; font-size: small">delete</button>
    </form>
    <form action="/accept" method="post">
      <button style="width: 100px; height: 45px; font-size: small">
        accept
      </button>
    </form>
  </div>
  <% }) %>
</section>
<% } %>

<!--  Announcements for all -->
<% if (announcements.length > 0) { %>
<section>
  <h2>Announcements</h2>
  <% announcements.forEach(a => { %>
  <div class="skills-section">
    <strong><%= a.title %></strong>
    <p><%= a.content %></p>
    <small><%= a.date.toDateString() %></small>

    <% if (session.role === 'admin') { %>
    <form action="/announcement/<%= a._id %>?_method=DELETE" method="POST">
      <button style="width: 150px; height: 50px; font-size: large">delete</button>
    </form>
    <% } %>
  </div>
  <% }) %>
</section>
<% } %>

<!-- Vlogs for all -->
<% if (session.role === 'admin') { %> <% if (vlogs.length > 0) { %>
<section class="vlog-section">
  <h2>Blogs</h2>
  <% vlogs.forEach(v => { %>
  <div>
    <h4><%= v.head %></h4>
    <img src="<%= v.image %>" width="200px" />
    <p><%= v.context %></p>
    <form action="/vlog/<%= v._id %>?_method=DELETE" method="POST">
      <button>Delete</button>
    </form>
  </div>
  <% }) %>
</section>
<% } %> <% } %> <%- include('partials/footer') %>
